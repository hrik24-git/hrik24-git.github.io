{"componentChunkName":"component---node-modules-nehalist-gatsby-theme-nehalem-src-templates-post-tsx","path":"/Malaria-Detection","result":{"data":{"post":{"id":"4409cf09-213f-5ad4-859b-619f648b6448","headings":[{"depth":1},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"Malaria Detection using Convolutional Neural Network","path":"/Malaria-Detection","tags":["Deep Learning","CNN","Project"],"excerpt":"Malaria Detection using Convolutional Neural Network with 93% accuracy developed using Keras.","created":"2020-10-05T00:00:00.000Z","createdPretty":"05 October, 2020","updated":"2020-10-05T00:00:00.000Z","updatedPretty":"05 October, 2020","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABuItqxnB//8QAGhAAAwADAQAAAAAAAAAAAAAAAAECERIxQf/aAAgBAQABBQLZsqqFd48K7//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABkQAAIDAQAAAAAAAAAAAAAAAAABECIxgf/aAAgBAQAGPwLWOzNOT//EABkQAQACAwAAAAAAAAAAAAAAAAERYQAQQf/aAAgBAQABPyGEM151CnAAmVq7p//aAAwDAQACAAMAAAAQ0x//xAAYEQACAwAAAAAAAAAAAAAAAAAAAREhUf/aAAgBAwEBPxCEVh//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxAn/8QAHxABAAIBAwUAAAAAAAAAAAAAAQARITFBsVFxgdHw/9oACAEBAAE/EF7RQiG0r3FNMUorrrtxMIGbnEfrtHX54JqT/9k=","aspectRatio":2.272727272727273,"src":"/static/2d6a7eca7db276b1985b54f22dff8ae4/7223d/cover.jpg","srcSet":"/static/2d6a7eca7db276b1985b54f22dff8ae4/8850c/cover.jpg 200w,\n/static/2d6a7eca7db276b1985b54f22dff8ae4/da113/cover.jpg 400w,\n/static/2d6a7eca7db276b1985b54f22dff8ae4/7223d/cover.jpg 600w","sizes":"(max-width: 600px) 100vw, 600px"}}}},"html":"<h1 id=\"maleria-detection\" style=\"position:relative;\"><a href=\"#maleria-detection\" aria-label=\"maleria detection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Maleria Detection</h1>\n<p>Hello! Here we are going to deal with identification of cell which are infected by Maleria. We have dataset in which we have images of cells\nstored in two separate directories. One directory contains 13,780 images on infected cells and in another directory named as uninfected also contains\n13,780 images of uninfected cells. </p>\n<p>So, in this notebook we are going to create a Deep Learning Model which will classify the cell image as infected on uninfected by marleria.</p>\n<p>Here we will be dealing with images hence using a Convolutional Neural Network will be a first choice for any Machine Learning Practitioner.\nCNN will extract important features from the image, which will help our model to classify the particualar image as it is a\ninfected or uninfected cell of Maleria.</p>\n<h2 id=\"collecting-data-set\" style=\"position:relative;\"><a href=\"#collecting-data-set\" aria-label=\"collecting data set permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Collecting Data Set</h2>\n<p>This will be first step for every Machine Learning or Deep Learning Project. Without data, how will you train your model...</p>\n<p>So let's download our dataset of Cell Images.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">!wget https<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>ceb<span class=\"token punctuation\">.</span>nlm<span class=\"token punctuation\">.</span>nih<span class=\"token punctuation\">.</span>gov<span class=\"token operator\">/</span>proj<span class=\"token operator\">/</span>malaria<span class=\"token operator\">/</span>cell_images<span class=\"token punctuation\">.</span><span class=\"token builtin\">zip</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">--2020-10-04 14:41:51--  https://ceb.nlm.nih.gov/proj/malaria/cell_images.zip\nResolving ceb.nlm.nih.gov (ceb.nlm.nih.gov)... 130.14.52.15, 2607:f220:41e:7052::15\nConnecting to ceb.nlm.nih.gov (ceb.nlm.nih.gov)|130.14.52.15|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 353452851 (337M) [application/zip]\nSaving to: ‘cell_images.zip’\n\ncell_images.zip     100%[===================&gt;] 337.08M  40.8MB/s    in 8.9s    \n\n2020-10-04 14:42:01 (37.8 MB/s) - ‘cell_images.zip’ saved [353452851/353452851]</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">!unzip cell_images<span class=\"token punctuation\">.</span><span class=\"token builtin\">zip</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\u001b[1;30;43mStreaming output truncated to the last 5000 lines.\u001b[0m\n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_118.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_126.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_134.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_141.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_168.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_175.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_183.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_221.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_222.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_87.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102428_cell_91.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102516_cell_104.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102516_cell_13.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102516_cell_146.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102516_cell_168.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102516_cell_177.png  \n extracting: cell_images/Uninfected/C236ThinF_IMG_20151127_102516_cell_179.png  \n .\n .\n .\n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_141520_cell_22.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_141520_cell_31.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_141520_cell_38.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_141520_cell_42.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_141520_cell_45.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_141520_cell_64.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_141520_cell_73.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_141520_cell_9.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_11.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_14.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_15.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_3.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_45.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_47.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_52.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_53.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_55.png  \n extracting: cell_images/Uninfected/C99P60ThinF_IMG_20150918_142128_cell_56.png  \n  inflating: cell_images/Uninfected/Thumbs.db  </code></pre></div>\n<p>Above we downloaded the zip file that contains our data and we extracted it. As mentioned above we get two folders in <code class=\"language-text\">cell_images</code> folder, those are <code class=\"language-text\">Parasitized</code> and <code class=\"language-text\">Uninfected</code>. <code class=\"language-text\">Parasitized</code> folder contains infected cell images having count of 13,780, similarly <code class=\"language-text\">Uninfected</code> folder contains uninfected mean healthy cell images having count of 13,780.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Cell_Images_dir <span class=\"token operator\">=</span> <span class=\"token string\">'/content/cell_images'</span>\nParasitized_dir <span class=\"token operator\">=</span> <span class=\"token string\">'/content/cell_images/Parasitized'</span>\nUninfected_dir <span class=\"token operator\">=</span> <span class=\"token string\">'/content/cell_images/Uninfected'</span></code></pre></div>\n<p>Above we stored there the path of each folder so that it will be easier to use the path by directly calling the variables.</p>\n<p>Now, Let's visualize what we have in our dataset. Let see one one images from </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> os\n\nParasitized_images <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>Parasitized_dir<span class=\"token punctuation\">)</span>\nUninfected_images <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>Uninfected_dir<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Parasitized Cell '</span><span class=\"token punctuation\">)</span>\nImage<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>Parasitized_dir <span class=\"token operator\">+</span> <span class=\"token string\">'/C129P90ThinF_IMG_20151004_134306_cell_126.png'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Parasitized Cell </code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 157px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/544a084aaf6cec81b0f067e63c1eaafd/fdd16/output_9_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 94.26751592356688%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsSAAALEgHS3X78AAADRklEQVQ4y22U22sUdxTHZxUfLH2pgiQUi9V4o+jDUlqlkhZBFI23IFp9EEkoJnmzpCltmhpvMTFhN/O7z8XZ3dk1a6J5UAt9UvCx0KbN7lx3m2iyTZBY/Bs885v17uEw/PbsfOac8/2d309RpC2TFq8/37JpsKOtctN6fMu+O9jfdbSls/Vgw+qP4K9EIqG8a8tkNLm5yfrh3Fwhu3gj5wnqCTZjGUsThaXJ4pSBk5ua4J3lL3K8wjavW1vo+7FWsBdytkeZQ3EgeMC5R4iDUQmhx9fNaYE/bWx4mwfL/9rzbHLcIcTFNOQiECLQRAALFjtzVPRI1+zuc+s/bojbrJNtLXufThbLCAMWuSRDTYtcCE/FpaGUM5IujaTnqV4axsmmDbJkyU9e/KWWs3zGJKlVdC0mYeGqeHog5aZpQFnF4A9PXfht40B52PyudV9E7ti2dSZ/3ec04EzmjDEdPNREeUQtj+DQ0ENTVE0+1Tt696uBqYv6X6bauHqV0n3q2P+3iw7BAFc0AdkkCU9ogXmIBppeyZrVTMRXDN1HopQi/43lfj59Quk7c/JJMe8SAq+CMB7GoeChDl8BwZirEp+LSsaYsY1qJurCSWEHsdmM+QBdVTK93TU7C9sTMB5QDvKEnANZNbSqafiMl1NkepiWUvSfIfXvK2kPcZdA/9ofRlo5e+TAk2JBZoaNjaSWPQMMDm3rEPQQc0ahCuYTDjlgO2ct8961fmXLurWzeStKCzAMhmChxsErsvJ683IBQZ9RH0YIEcj30+lvI8HHentq2SxoFkYke52vNy+4D4pw6nPiUwqZ54u5Q807I3jXts8Wx/IBoy5Sw2jP6Es+dvgZBRnxGS4j9ZFp3hnoX7FieX22j3/TPA9zQkFb8joWk3IKqIeRi0Z9QpZujx3ctaM+nvGgn9z99dL4DSjepTjCIDkkFLIQIBmeVkFq7Jmi/VA0XgnlxfGEgwqzPtTRNl/I1XJZEMajxIvqJB7FsP7X0OCcLkwUOltb3jgYL+8DeO7f+cXv1y7XbubmCtacbc1kjLm8tTBu/6mhwY725uT2hLT3XAlx9MMPVu75Mom+75q41HsfD9nne9oP7/ukcY0s9Y3L5DmaSDXKj/6u1wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/544a084aaf6cec81b0f067e63c1eaafd/fdd16/output_9_1.png\"\n        srcset=\"/static/544a084aaf6cec81b0f067e63c1eaafd/fdd16/output_9_1.png 157w\"\n        sizes=\"(max-width: 157px) 100vw, 157px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Uninfected Cell '</span><span class=\"token punctuation\">)</span>\nImage<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>Uninfected_dir <span class=\"token operator\">+</span> <span class=\"token string\">'/C142P103ThinF_IMG_20151005_223257_cell_174.png'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Uninfected Cell </code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 124px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8befa706b332b586b08e0251c7f53301/d6e54/output_10_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 114.51612903225808%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsSAAALEgHS3X78AAAD0UlEQVQ4y22U228UVRzHh61PVEEkAsWUYjTogzE+8NCQ8EBIqyTUiCHRigkmQqy1oRejGOKLRg22m6U7O2ful53L3rqFAm9KgiHG7u7s7LV7p65Jg/+H3zMTkFYnv5ycmTmf3/f8LucwzOMnFNrlP8zbo8evT3/ayeq9m4b0zexrI8P4ix9YwPzvMxAKYRwfPb62+F1/1dnMWCWV91S+mzQ2bHV57otXhw8Hy6j7beQAJT8cO7V1O9Wy9bxAcnysIHAwTFyJ9DPOAy7y0fjpgPyXDzQnx071s05R4nM8GD5PuAJPYJjA1mNsRREfpi12fuatY69s4ydOjj66kyqKWMq6AgkwuHB9L76xOY7N81wvGX90N3XpvTN+jkJ0z7d//r5pqTmfzJOY62OwoihgLGAvhC3EWJdHFOyGpd7nlvbv3UNl3z15op+x8wiS51yBK4pgRE+WSooM8yTRFUmBY9dv3CiQWFGkiUCAn507S+HIlameY+S4KCUlvqSIJVWqGmrNUKu6UtHksiY/WAz/vhTxRGyHCjRM7TcSPrDveUa+utCMq+vLyy7hPFkoa1LdVBu2Dtuw9VpcxZccy+WikCWuyHkSD/HNrLVw4TwzdW4ClfgjGnUJKasSVgNrpcx2xsZYM9WSKpZVGYH4ERHACORhxpSvLTDzk+e3bqVRT6QH66qG3HSMTsbu3nQ6q5SHr6qhQN+TBMAwKAO+PnOZmRw/3V9NuDLvKXTPUG4mjHbGBNy7lWivWM2kUTc1RA7NQBlwNxknX80yewZ3Fw2hFpeLMpQFKDccrfMY7mRtClsaviMjT5Q30/ZPn19i9j47WLGValwqQlwWKpqEZm6njfaK2c5aGJtJvW5rFR0wH4ijrn9mE5G5aVqt5S9nttZSCBv/EHbNVBoJrZUyWmmzlY5T2FIBlxQhgGHdtHnlg/cpfPTwoV/ZpZZtFERSVsSKjsiVDUdvJIyGYwQFw0e0QABXVKliKseODDMhv8VHhg7e5yINS3d98bIuVeMK8gQMjqisJpX8mGm2Eib/9XzIP1HMMwMDGD8+M/bXatKViec3GTKP9vI7jGqCpBUWCObdlH3izTd2Xgb81bm/72ZyQgxle9oQLTqXFklEnp1rFy9suw+C8zly6OA9bnFrLQ33SH5gKIHnT/Ii10tb92LhAy/s23ak6fn0X15+aSg8O+UZUj2uYjVIZBFWVIRuyvwluhhcaaFd/7nPntwyrx89cif8Q2/FqttKJ22iZwo6iSxMw/VOzR18kMbnBndfPDvuOWLix28/mXhn6MX9wVX3NPkPow+ftjtoyosAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/8befa706b332b586b08e0251c7f53301/d6e54/output_10_1.png\"\n        srcset=\"/static/8befa706b332b586b08e0251c7f53301/d6e54/output_10_1.png 124w\"\n        sizes=\"(max-width: 124px) 100vw, 124px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"preprocessing-the-data\" style=\"position:relative;\"><a href=\"#preprocessing-the-data\" aria-label=\"preprocessing the data permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Preprocessing The Data</h2>\n<p>After visualizing the Images from both classes we can easily detect that there is an infecter portion in Parasitized images. But we want to train our deep learning model that it should detect that and classify the images in Paracitized or Uninfected classes.</p>\n<p>Now we have data which is in image format, but we have to convert it in machine tarinable format. We cannot input the image data as it is, we have to preprocess it first. The data we have is already supervised and separeted in folder so we have some functions from <code class=\"language-text\">tensorflow</code> which can easily preprocess these data.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>preprocessing<span class=\"token punctuation\">.</span>image <span class=\"token keyword\">import</span> ImageDataGenerator\n\ndata_gen <span class=\"token operator\">=</span> ImageDataGenerator<span class=\"token punctuation\">(</span>validation_split<span class=\"token operator\">=</span><span class=\"token number\">0.2</span> <span class=\"token punctuation\">,</span>rescale<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">255.0</span><span class=\"token punctuation\">)</span>\n\ncell_images_training <span class=\"token operator\">=</span>  data_gen<span class=\"token punctuation\">.</span>flow_from_directory<span class=\"token punctuation\">(</span>Cell_Images_dir<span class=\"token punctuation\">,</span> target_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> class_mode<span class=\"token operator\">=</span><span class=\"token string\">'categorical'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token string\">'training'</span><span class=\"token punctuation\">)</span>\ncell_images_validation <span class=\"token operator\">=</span>  data_gen<span class=\"token punctuation\">.</span>flow_from_directory<span class=\"token punctuation\">(</span>Cell_Images_dir<span class=\"token punctuation\">,</span> target_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> class_mode<span class=\"token operator\">=</span><span class=\"token string\">'categorical'</span><span class=\"token punctuation\">,</span> subset<span class=\"token operator\">=</span><span class=\"token string\">'validation'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Found 22048 images belonging to 2 classes.\nFound 5510 images belonging to 2 classes.</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cell_images_training<span class=\"token punctuation\">.</span>class_indices</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{&#39;Parasitized&#39;: 0, &#39;Uninfected&#39;: 1}</code></pre></div>\n<p><strong>If you are seeing this first time then I am sure it's little confusing, Let me explain what it is and what is it doing?</strong></p>\n<p>First we imported a <code class=\"language-text\">ImageDataGenerator</code> class from <code class=\"language-text\">keras</code> which helps us to preprocess images so that we can use them to train our neural network.  </p>\n<p>Next we created a object of <code class=\"language-text\">ImageDataGenerator</code> class and passed a <code class=\"language-text\">Normalization Factor</code> i.e. <code class=\"language-text\">1/255.0</code>.\nNormalization is a process that changes the range of pixel intensity values. If you want to read more about normalization then <a href=\"https://en.wikipedia.org/wiki/Normalization_(image_processing)\">Click Here</a>.</p>\n<p>There is one more parameter that we passed, which is <code class=\"language-text\">validation_split</code>. It will split our data in two datasets <code class=\"language-text\">training</code> and <code class=\"language-text\">testing</code>. </p>\n<p>After creating the object, now we are able to access the functions of it. There is function <code class=\"language-text\">flow_from_directory</code> which goes through the directory and catogorixe the data according to the folders in passed directory. Let's understand about the parameters that are passed in it:</p>\n<ul>\n<li><code class=\"language-text\">Cell_Image_dir</code> - This is a variable where path of main directory is stored. This directory contains training images of cells classified in two different folders as <code class=\"language-text\">Parasitized</code> and <code class=\"language-text\">uninfected</code>.</li>\n<li><code class=\"language-text\">target_size=(125, 125)</code> - It converts all images in same size as passed. Here I passes (125, 125). In Neural Networks it is very important that all input images must have same size. </li>\n<li><code class=\"language-text\">class_mode=&#39;categorical&#39;</code> -  It specifies the type of classification that must be done on passed directory. </li>\n<li><code class=\"language-text\">subset=&#39;training&#39;</code> / <code class=\"language-text\">subset=&#39;validation&#39;</code> - It will classify datasets into training and validation dataset.</li>\n</ul>\n<p>If you want to read more about Image Processing in Keras then <a href=\"https://keras.io/api/preprocessing/image/\">Click Here</a></p>\n<p>Now we are ready with our Data. Preprocessing of our data is handled by Keras. Now we can work on creating Nerural Network and traing our data on that model. </p>\n<p>Here we will be using Keras for creating our Deep Neural Network. We will be dealing with image data hence we will use Convolutional Neural Network to train our data. </p>\n<p>Let's import the necessary packages, then we will discuss about each of them. </p>\n<h2 id=\"preparing-neural-network\" style=\"position:relative;\"><a href=\"#preparing-neural-network\" aria-label=\"preparing neural network permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Preparing Neural Network</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers <span class=\"token keyword\">import</span> Conv2D<span class=\"token punctuation\">,</span> MaxPool2D<span class=\"token punctuation\">,</span> Dense<span class=\"token punctuation\">,</span> Dropout<span class=\"token punctuation\">,</span> Flatten\n<span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> Sequential</code></pre></div>\n<p>Above we imported different layers and <code class=\"language-text\">Sequential</code> model from Keras. Each layer has different tasks to perform.  </p>\n<p>Layers that we imported:</p>\n<ul>\n<li><code class=\"language-text\">Conv2D</code> - This layer creates a convolution kernel that is convolved with the layer input to extract features from inputed image.</li>\n<li><code class=\"language-text\">MaxPool2D</code> - Downsamples the input representation by taking the maximum value over the window defined by <code class=\"language-text\">pool_size</code> for each dimension along the features axis.</li>\n<li><code class=\"language-text\">Dense</code> - Dense layer adds another layer in Neural Network with specific activation function.</li>\n<li><code class=\"language-text\">Dropout</code> - The Dropout layer randomly sets input units to 0, which helps in overfitting the model</li>\n<li><code class=\"language-text\">Flatten</code> - Flattens the input. Converts input size to 1 dimension. </li>\n<li><code class=\"language-text\">Sequential</code> - A Sequential model is appropriate for a plain stack of layers. Here we will be dealing continual series of Layers. </li>\n</ul>\n<p>Now, let's create our model for classification of infected Malaria cell images.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model <span class=\"token operator\">=</span> Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">,</span> input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>MaxPool2D<span class=\"token punctuation\">(</span>pool_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>MaxPool2D<span class=\"token punctuation\">(</span>pool_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>MaxPool2D<span class=\"token punctuation\">(</span>pool_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>MaxPool2D<span class=\"token punctuation\">(</span>pool_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dropout<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>loss<span class=\"token operator\">=</span><span class=\"token string\">'categorical_crossentropy'</span><span class=\"token punctuation\">,</span> optimizer<span class=\"token operator\">=</span><span class=\"token string\">'rmsprop'</span><span class=\"token punctuation\">,</span> metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Above we have created our Neural Network which will be used to classify the infected Malaria Cell Images. </p>\n<p>First we created <code class=\"language-text\">model</code> as a object of <code class=\"language-text\">Sequential</code> class. Here our neaural network gets initiated. </p>\n<p>Then we will <code class=\"language-text\">add</code> layers to the neural network, there positions are pre-decided as per their functionality.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/176224fd71739aee63645f9bca200a41/e6205/CNN.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdyiAf/EABUQAQEAAAAAAAAAAAAAAAAAABBB/9oACAEBAAEFAof/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAVEAEBAAAAAAAAAAAAAAAAAAAQMf/aAAgBAQAGPwKv/8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERMSFR/9oACAEBAAE/IVUl69K5pp//2gAMAwEAAgADAAAAEP8A/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhkYH/2gAIAQEAAT8QJlxNBj5BFjkGl29n/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jpeg\"\n        title=\"jpeg\"\n        src=\"/static/176224fd71739aee63645f9bca200a41/e5166/CNN.jpg\"\n        srcset=\"/static/176224fd71739aee63645f9bca200a41/f93b5/CNN.jpg 300w,\n/static/176224fd71739aee63645f9bca200a41/b4294/CNN.jpg 600w,\n/static/176224fd71739aee63645f9bca200a41/e5166/CNN.jpg 1200w,\n/static/176224fd71739aee63645f9bca200a41/e6205/CNN.jpg 1255w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Above image shows the struture on Convolutional Neural Network.</p>\n<p>Whole Neural Network is divided into two sections: </p>\n<ol>\n<li>Feature Learning- </li>\n</ol>\n<p>  Here we will be extracting the important features from the image to make perfect classification. In this layer we have <code class=\"language-text\">Conv2D</code> and <code class=\"language-text\">MaxPool2D</code> layers. </p>\n<ul>\n<li>\n<p><code class=\"language-text\">Conv2D</code> - As we know this is a convolutional layer. It creates kernels and convolve it throughout the image which focuses on the particular feature of image as per  the values in the kernel. Keras takes care of defining kernel with different values. Let's discuss about the parameters that we passed in convolutional layer.</p>\n<ul>\n<li><code class=\"language-text\">64</code> - The first parameter in Conv2D layer is the number of kernels that we want to be convolved throughout the image. </li>\n<li><code class=\"language-text\">(3, 3)</code> - The second parameter is the size of that kernel.</li>\n<li><code class=\"language-text\">activation=&#39;relu&#39;</code> - Here we pass the activation function to convert the result of convolutin in binary. </li>\n<li><code class=\"language-text\">input_shape = (125, 125, 3)</code> - Here we describe the shape of the input image. This we need to specify in only first layer.</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">MaxPool2D</code> - This is a Pooling Layer, this is used to decrease some shape of the image and extract only maximum value in particular window. </p>\n<ul>\n<li><code class=\"language-text\">pool_size = (2, 2)</code> - Here we pass the size of pool window. This window in revolved throughout the convolved image and extracts only the maximum value.</li>\n</ul>\n</li>\n</ul>\n<p>  These two layers are used to extract important features for perfect classifiaction.</p>\n<ol start=\"2\">\n<li>Classification - </li>\n</ol>\n<p>  In this section Neural Network focuses on the classification part. Here we have <code class=\"language-text\">Flatten</code> and <code class=\"language-text\">Dense</code> Layers. </p>\n<ul>\n<li><code class=\"language-text\">Flatten</code> - This layer is used for dimentionality reduction. This reduces the dimention of the input data and convert it into searies of features. </li>\n<li><code class=\"language-text\">Dense</code> - Dense layer just adds another neural layer in the network, which is also called fully connected layer, which important to connect the flatten layer with output layer.</li>\n</ul>\n<p>In Neural Network we can also see one layer named <code class=\"language-text\">Dropout</code>. What this layer does is that it randomly sets input to zero. It is used to avoid overfitting of the model. </p>\n<p>This is the overview of our neural network, but it only tells that what it is used for but if you want to see what is happening inside, then we have a function <code class=\"language-text\">summary()</code> which gives detailed overview of our model.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model: &quot;sequential&quot;\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nconv2d (Conv2D)              (None, 123, 123, 64)      1792      \n_________________________________________________________________\nmax_pooling2d (MaxPooling2D) (None, 61, 61, 64)        0         \n_________________________________________________________________\nconv2d_1 (Conv2D)            (None, 59, 59, 64)        36928     \n_________________________________________________________________\nmax_pooling2d_1 (MaxPooling2 (None, 29, 29, 64)        0         \n_________________________________________________________________\nconv2d_2 (Conv2D)            (None, 27, 27, 128)       73856     \n_________________________________________________________________\nmax_pooling2d_2 (MaxPooling2 (None, 13, 13, 128)       0         \n_________________________________________________________________\nconv2d_3 (Conv2D)            (None, 11, 11, 128)       147584    \n_________________________________________________________________\nmax_pooling2d_3 (MaxPooling2 (None, 5, 5, 128)         0         \n_________________________________________________________________\nflatten (Flatten)            (None, 3200)              0         \n_________________________________________________________________\ndropout (Dropout)            (None, 3200)              0         \n_________________________________________________________________\ndense (Dense)                (None, 512)               1638912   \n_________________________________________________________________\ndense_1 (Dense)              (None, 2)                 1026      \n=================================================================\nTotal params: 1,900,098\nTrainable params: 1,900,098\nNon-trainable params: 0\n_________________________________________________________________</code></pre></div>\n<p>As you can see above, it gives the complete overview of the our Neural Network. It tell that in our network we arew dealing with nearly 1 million neurons.</p>\n<p>So now let train the model with the Dataset that we generated.</p>\n<h2 id=\"training-neural-network\" style=\"position:relative;\"><a href=\"#training-neural-network\" aria-label=\"training neural network permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Training Neural Network</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">H <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>cell_images_training<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> validation_data<span class=\"token operator\">=</span>cell_images_validation<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 1/10\n689/689 [==============================] - 36s 52ms/step - loss: 0.3346 - accuracy: 0.8460 - val_loss: 0.2131 - val_accuracy: 0.9376\nEpoch 2/10\n689/689 [==============================] - 33s 48ms/step - loss: 0.1873 - accuracy: 0.9445 - val_loss: 0.2404 - val_accuracy: 0.9397\nEpoch 3/10\n689/689 [==============================] - 34s 49ms/step - loss: 0.1802 - accuracy: 0.9473 - val_loss: 0.2172 - val_accuracy: 0.9416\nEpoch 4/10\n689/689 [==============================] - 34s 49ms/step - loss: 0.1744 - accuracy: 0.9495 - val_loss: 0.1930 - val_accuracy: 0.9428\nEpoch 5/10\n689/689 [==============================] - 33s 48ms/step - loss: 0.1763 - accuracy: 0.9487 - val_loss: 0.2269 - val_accuracy: 0.9397\nEpoch 6/10\n689/689 [==============================] - 33s 48ms/step - loss: 0.1716 - accuracy: 0.9506 - val_loss: 0.2904 - val_accuracy: 0.9448\nEpoch 7/10\n689/689 [==============================] - 33s 49ms/step - loss: 0.1743 - accuracy: 0.9501 - val_loss: 0.2117 - val_accuracy: 0.9381\nEpoch 8/10\n689/689 [==============================] - 33s 48ms/step - loss: 0.1701 - accuracy: 0.9494 - val_loss: 0.2893 - val_accuracy: 0.9316\nEpoch 9/10\n689/689 [==============================] - 33s 48ms/step - loss: 0.1747 - accuracy: 0.9500 - val_loss: 0.1915 - val_accuracy: 0.9379\nEpoch 10/10\n689/689 [==============================] - 33s 48ms/step - loss: 0.1761 - accuracy: 0.9492 - val_loss: 0.1993 - val_accuracy: 0.9412</code></pre></div>\n<p>Above we trained the model with our generated Dataset. Let's discuss about the parameters that we passed to the <code class=\"language-text\">fit</code> :</p>\n<ul>\n<li><code class=\"language-text\">cell_images_training</code>-  This is the training data that we have generated preveously from our Data Directory.</li>\n<li><code class=\"language-text\">epochs=10</code> - Epochs is a number that how many times model is going to train on that training data. For each epoch Network Backtrack the model and improves the accuracy. </li>\n<li><code class=\"language-text\">validation_data=cell_images_validation</code> - Here we will pass our testing data.</li>\n<li><code class=\"language-text\">verbose=1</code> - Due to this, it displays the output.</li>\n</ul>\n<p>Object of this whole process is stored in the variable <code class=\"language-text\">H</code>.\nFrom this object we can get values of <code class=\"language-text\">training accuracy</code>, <code class=\"language-text\">validation accuracy</code>, <code class=\"language-text\">training loss</code> and <code class=\"language-text\">validation loss</code> for each epochs. </p>\n<p>And by accessing these information we will plot a training and validation graph for loss and accuracy of our model.</p>\n<h2 id=\"visualizing-accuracy\" style=\"position:relative;\"><a href=\"#visualizing-accuracy\" aria-label=\"visualizing accuracy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Visualizing Accuracy</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n\n\nacc <span class=\"token operator\">=</span> H<span class=\"token punctuation\">.</span>history<span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span>\nval_acc <span class=\"token operator\">=</span> H<span class=\"token punctuation\">.</span>history<span class=\"token punctuation\">[</span><span class=\"token string\">'val_accuracy'</span><span class=\"token punctuation\">]</span>\nloss <span class=\"token operator\">=</span> H<span class=\"token punctuation\">.</span>history<span class=\"token punctuation\">[</span><span class=\"token string\">'loss'</span><span class=\"token punctuation\">]</span>\nval_loss <span class=\"token operator\">=</span> H<span class=\"token punctuation\">.</span>history<span class=\"token punctuation\">[</span><span class=\"token string\">'val_loss'</span><span class=\"token punctuation\">]</span>\nn <span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Because 10 epochs</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">fig<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>ax1<span class=\"token punctuation\">,</span> ax2<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>subplots<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\nax1<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> loss<span class=\"token punctuation\">,</span> label <span class=\"token operator\">=</span> <span class=\"token string\">'Training Loss'</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> val_loss<span class=\"token punctuation\">,</span> label <span class=\"token operator\">=</span> <span class=\"token string\">'Val_Loss'</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nax2<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> acc<span class=\"token punctuation\">,</span> label <span class=\"token operator\">=</span> <span class=\"token string\">'Training Accuracy'</span><span class=\"token punctuation\">)</span>\nax2<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> val_acc<span class=\"token punctuation\">,</span> label <span class=\"token operator\">=</span> <span class=\"token string\">'Val Accuracy'</span><span class=\"token punctuation\">)</span>\nax2<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 378px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5e7023bb870f454d38eb9c8eadda3544/f0991/output_26_0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACwklEQVQ4y5VTSUwTURhuy2KRpZGLXjxwMFwIHrx4AONyIhBM3OLBs5fGBCJ6MUZwN2hrAkc0RmLARiCsAYtxDSCJQcNi2ykdOjOdIl1mazvLm5nnewM1EuP2J1/+759588333vt/mw1Fko1WhCJUH81+862Gw88pivKFw2Efy7I+juN8qVTKl8bgeF86nd7kOOMacfS+D60bJUmyDesVt3dcr82IHITQgLFYDK6vx6EoivB/QxCESSxYePPW7Wo5m8kJWcVAfwYcLwDdhMA0TWAgmBBxWQAmzwAzk9ysMwlgclFgGgCtgQoWRC4HLME79zqrVTmXk7iEkePWAVQ5BAlAaCJAAGVU51KbXBEAFBiUJWDqQIeZDfx8m+COK1fb96OPLdv6tk2o+bV/DlWwEs9zfixoI1eJsijNPECH7CUia13BKOslYklPIEI/XAqRXQST8ISirOfjUrj7C0F5A9SGZyG45p35/LV7mWQ9BMV2rhCRnsXFxfNYb2ddff3uleXlBjK00jT50n9q4s1sk//DfOOw/93x/pHJk5j7Zz41Pn7ae3po6nXz1Pv5xoHp2eaeQf+Z8bdzTa/mFhr6h8bODQ+P1FkOHz3p3ffDvqFat/0r8oeR5+ZWjbipbG2Zn7YEx8Yn9iqKLGc0QxdloFmH/1egCzPUfK1sCb7Aes62S5drkaCSyqhQ1w0dtYvxO+BQNN1QNWAoqmaoqoqBTcBkMjloOdSk9B4xK0PtHxtYQ42HWgSiybAGgWEYCACA8Xh8FOuVtlxw19DxjdU0LzKSKNKSJFF5iD/VoiTRAs9R2QRN0VGSCgSCdDAYpAiCINF2eTSyPVjQbrMXOs6eaC54dveio7zCVX7s6JGC1tZWR1VVVXFlZWWZ2+12dFy/YXe5KipqDhwssvVBe8u1+0WHD9W7kOECBFtJSckup9NZ+h04NEGzr9iPVQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/5e7023bb870f454d38eb9c8eadda3544/f0991/output_26_0.png\"\n        srcset=\"/static/5e7023bb870f454d38eb9c8eadda3544/5a46d/output_26_0.png 300w,\n/static/5e7023bb870f454d38eb9c8eadda3544/f0991/output_26_0.png 378w\"\n        sizes=\"(max-width: 378px) 100vw, 378px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>The graph explains that Validation Accuracy is increasing gradually and at on point it becomes constant. So it tells that our models is quite good. </p>\n<p>So now let save the model, so that we can easily share it with others or deploy to make it available to others.</p>\n<h2 id=\"saving-the-model-for-future-use\" style=\"position:relative;\"><a href=\"#saving-the-model-for-future-use\" aria-label=\"saving the model for future use permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Saving The Model For Future Use</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'maleria_cell_classyfier.h5'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Here you will get the file named as <code class=\"language-text\">maleria_cell_classyfier.h5</code>, all your model information is stored here. Now if you want to share your model to another\nperson, you need to share only this file. So there is no need to send whole notebook or your source code to others. </p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>In this project we worked with Malaria cell images and created a model to classify infected and uninfected cell images with 93% of accuracy. </p>"},"primaryTag":{"name":"Deep Learning","color":"#007acc"}},"pageContext":{"postId":"4409cf09-213f-5ad4-859b-619f648b6448","primaryTag":"Deep Learning"}},"staticQueryHashes":["1116962356","2275848304","327791803","545095672","675363291"]}